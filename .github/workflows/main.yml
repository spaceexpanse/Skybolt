name: Build Skybolt
on: [push]
jobs:
  test:
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-20.04]
        include:
          - os: ubuntu-20.04
            python-arch: "x64"
            python-version: "3.6.x" 
            install-headerfiles: true
            prepare-python: true
            gcc-version: "9"

    runs-on: ${{ matrix.os }}
    steps:
    - uses: actions/checkout@v2.4.0
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v1
      with:
        python-version: ${{ matrix.python-version }}
        architecture: ${{ matrix.python-arch }}
      if: matrix.prepare-python
    - name: Install Linux packages
      run: sudo apt-get -y libgl-dev
      if: runner.os == 'Linux'
    - name: Install C and C++ header files
      run: |
        sudo apt-get update && sudo apt-get install -y gcc-multilib g++-multilib
      if: matrix.install-headerfiles
    - name: Install conan && conan package tools
      run: |
        python3 -m pip install --upgrade pip
        pip3 install conan
        pip3 install conan_package_tools
    - name: Conan install
      run: |
        conan install . --build=cxxtimer --build=px_sched
